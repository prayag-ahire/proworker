generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Client_User {
  id                Int             @id @default(autoincrement())
  phone_no          String          @unique
  password          String
  Profile_Completed Boolean         @default(false)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  client            Client?
  sessions          ClientSession[]
}

model Client {
  id            Int            @id @default(autoincrement())
  ImgURL        String
  Active_Status Boolean        @default(true)
  age           Int
  email         String         @unique
  gender        Gender
  userId        Int            @unique
  username      String
  user          Client_User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  notification  Notification[]
  review        Review[]
  worker_order  WorkerOrder[]
  ClientSettings ClientSettings?
}

model ClientSettings {
  id          Int         @id @default(autoincrement())
  clientId    Int         @unique
  ReferCode   Int
  ReferenceId Int
  AppLanguage AppLanguage
  client      Client @relation(fields: [clientId], references: [id])
}

model Status {
  id          Int           @id @default(autoincrement())
  status_name String        @unique
  WorkerOrder WorkerOrder[]
}

model Worker_User {
  id               Int             @id @default(autoincrement())
  phone_no         String          @unique
  password         String
  profileCompleted Boolean         @default(false)
  status           AccountStatus   @default(ACTIVE)
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  worker           Worker?
  sessions         WorkerSession[]
}

model Worker {
  id               Int              @id @default(autoincrement())
  ImgURL           String
  Rating           Decimal          @default(0.0)
  Description      String
  Charges_PerVisit Int
  Distance_charges Int
  ReferCode        Int?
  ReferenceId      Int?
  profession       String
  Active_Status    Boolean          @default(true)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  userId           Int              @unique
  username         String
  Age              Int
  Email            String           @unique
  gender           gender
  month_schedule   MonthSchedule[]
  notification     Notification[]
  review           Review[]
  review_image     ReviewImage[]
  review_video     ReviewVideo[]
  worker_schedule  WeekSchedule?
  user             Worker_User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  worker_image     WorkerImage[]
  worker_order     WorkerOrder[]
  settings         WorkerSettings?
  worker_training  WorkerTraining[]
  Worker_video     WorkerVideo[]
}

model WorkerSettings {
  id          Int         @id @default(autoincrement())
  workerId    Int         @unique
  AppLanguage AppLanguage
  ReferCode   Int
  ReferenceId Int
  location    Location?
  worker      Worker      @relation(fields: [workerId], references: [id], onDelete: Cascade)
}

model Location {
  id               Int            @id @default(autoincrement())
  latitude         Float
  longitude        Float
  workerSettingsId Int            @unique
  worker_settings  WorkerSettings @relation(fields: [workerSettingsId], references: [id])
}

model WeekSchedule {
  id              Int       @id @default(autoincrement())
  workerId        Int       @unique
  Start_Sunday    DateTime? @db.Time(6)
  End_Sunday      DateTime? @db.Time(6)
  Start_Monday    DateTime? @db.Time(6)
  End_Monday      DateTime? @db.Time(6)
  Start_Tuesday   DateTime? @db.Time(6)
  End_Tuesday     DateTime? @db.Time(6)
  Start_Wednesday DateTime? @db.Time(6)
  End_Wednesday   DateTime? @db.Time(6)
  Start_Thursday  DateTime? @db.Time(6)
  End_Thursday    DateTime? @db.Time(6)
  Start_Friday    DateTime? @db.Time(6)
  End_Friday      DateTime? @db.Time(6)
  Start_Saturday  DateTime? @db.Time(6)
  End_Saturday    DateTime? @db.Time(6)
  worker          Worker    @relation(fields: [workerId], references: [id])
}

model MonthSchedule {
  id       Int      @id @default(autoincrement())
  workerId Int
  date     DateTime @db.Date
  note     String?
  worker   Worker   @relation(fields: [workerId], references: [id])
}

model Notification {
  id        Int         @id @default(autoincrement())
  clientId  Int
  workerId  Int
  orderId   Int
  message   String
  createdAt DateTime    @default(now())
  isRead    Boolean     @default(false)
  client    Client      @relation(fields: [clientId], references: [id])
  order     WorkerOrder @relation(fields: [orderId], references: [id])
  worker    Worker      @relation(fields: [workerId], references: [id])
}

model WorkerTraining {
  id       Int           @id @default(autoincrement())
  workerId Int
  videoId  Int
  Status   Boolean
  video    TrainingVideo @relation(fields: [videoId], references: [id])
  worker   Worker        @relation(fields: [workerId], references: [id])
}

model TrainingVideo {
  id              Int              @id @default(autoincrement())
  Name            String
  Video_URL       String
  worker_training WorkerTraining[]
}

model WorkerOrder {
  id                 Int            @id @default(autoincrement())
  workerId           Int
  clientId           Int
  date               DateTime       @db.Date
  time               DateTime       @db.Time(6)
  reschedule_comment String?
  Order_Status       Int
  notification       Notification[]
  review             Review[]
  Status             Status         @relation(fields: [Order_Status], references: [id])
  client             Client         @relation(fields: [clientId], references: [id])
  worker             Worker         @relation(fields: [workerId], references: [id])
}

model WorkerImage {
  id       Int    @id @default(autoincrement())
  workerId Int
  name     String
  img_URL  String
  worker   Worker @relation(fields: [workerId], references: [id])
}

model WorkerVideo {
  id        Int    @id @default(autoincrement())
  workerId  Int
  Name      String
  Video_URL String
  worker    Worker @relation(fields: [workerId], references: [id])
}

model Review {
  id        Int           @id @default(autoincrement())
  Name      String
  Comment   String
  createdAt DateTime      @default(now())
  clientId  Int
  orderId   Int
  workerId  Int
  client    Client        @relation(fields: [clientId], references: [id])
  order     WorkerOrder   @relation(fields: [orderId], references: [id])
  worker    Worker        @relation(fields: [workerId], references: [id])
  images    ReviewImage[]
  videos    ReviewVideo[]
}

model ReviewImage {
  id       Int    @id @default(autoincrement())
  reviewId Int
  img_URL  String
  workerId Int
  name     String
  review   Review @relation(fields: [reviewId], references: [id])
  worker   Worker @relation(fields: [workerId], references: [id])
}

model ReviewVideo {
  id        Int    @id @default(autoincrement())
  reviewId  Int
  video_URL String
  workerId  Int
  name      String
  review    Review @relation(fields: [reviewId], references: [id])
  worker    Worker @relation(fields: [workerId], references: [id])
}

enum Gender {
  Male
  Female
  Other
}

enum AppLanguage {
  English
  Hindi
  Marathi
  Gujarati
}

enum AccountStatus {
  ACTIVE
  INACTIVE
  BLOCKED
}

enum gender {
  MALE
  Female
}

model ClientSession {
  id        Int         @id @default(autoincrement())
  clientId  Int
  tokenHash String      @unique
  createdAt DateTime    @default(now())
  expiresAt DateTime
  client    Client_User @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
}

model WorkerSession {
  id        Int         @id @default(autoincrement())
  workerId  Int
  tokenHash String      @unique
  createdAt DateTime    @default(now())
  expiresAt DateTime
  worker    Worker_User @relation(fields: [workerId], references: [id], onDelete: Cascade)

  @@index([workerId])
}
